<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShinobiWay</title>
    <style>
        body {
            background-color: #f0f0f0;
            margin: 0;
            padding: 10px;
            font-family: Arial, sans-serif;
        }
        #player-hp, #enemy-hp {
            display: block;
            margin: 5px 0;
        }
        #battle-log {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 5px;
            margin: 10px 0;
        }
        #main-controls, #skill-controls, #travel-controls {
            margin: 10px 0;
        }
        button {
            padding: 5px 10px;
            margin-right: 5px;
            cursor: pointer;
        }
        .battle-ready { color: green; font-weight: bold; }
        .output-text-player { color: blue; }
        .output-text-enemy { color: red; }
        .output-text-neutral { color: black; }
        .status-burn { color: orange; }
        .status-regen { color: green; }
    </style>
</head>
<body>
    <span id="player-hp">Shinobi [HP: 10/10]</span>
    <span id="enemy-hp">Training Dummy [HP: 10/10]</span>
    <div id="battle-log"></div>
    <div id="main-controls">
        <button id="start-game" onclick="startGame()">Start Game</button>
        <button id="train" onclick="startTrainingFight()">Train</button>
        <button id="travel" onclick="startTravelFight()">Travel</button>
    </div>
    <div id="skill-controls"></div>
    <div id="travel-controls" style="display: none;"></div>

    <script src="Characters.js"></script>
    <script src="Jutsu.js"></script>
    <script src="Log.js"></script>
    <script src="Map.js"></script>
    <script src="RANKUP.js"></script>
    <script src="Battle.js"></script>

    <script>
        var game = {
            gameState: "initial",
            player: null,
            enemy: null,
            user: null,
            target: null,
            battleScene: null,
            battleType: null
        };

        function initializeGame() {
            game.player = {
                name: "Shinobi",
                hp: 10,
                maxHp: 10,
                skills: [],
                skillInventory: [],
                statusEffects: [],
                ninjaStyles: {},
                lastVillage: "Newb Village"
            };
            game.player = new Proxy(game.player, {
                set(target, property, value) {
                    if (property === "hp" && target[property] !== value) {
                        target[property] = value;
                        updateStatus();
                    } else {
                        target[property] = value;
                    }
                    return true;
                }
            });
            game.enemy = null;
            addInitialBarrageCards();
        }

        function addInitialBarrageCards() {
            let skillSet = new Skills();
            if (skillSet && game.player.skillInventory.length === 0) {
                game.player.skillInventory = [skillSet.findSkill("Barrage"), skillSet.findSkill("Barrage")];
            }
        }

        function startGame() {
            if (game.gameState === "initial" || game.gameState === "In Village") {
                initializeGame();
                game.gameState = "chooseStyles";
            } else {
                console.log("[DEBUG]: Game already started, state:", game.gameState); // Minimal debug
            }
        }

        function updateStatus() {
            // This will be overridden by Battle.js
        }
    </script>
</body>
</html>
